(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var s=e.g.document;if(!t&&s&&(s.currentScript&&"SCRIPT"===s.currentScript.tagName.toUpperCase()&&(t=s.currentScript.src),!t)){var i=s.getElementsByTagName("script");if(i.length)for(var r=i.length-1;r>-1&&(!t||!/^http(s?):/.test(t));)t=i[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();const t=e.p+"assets/0.jpg",s=e.p+"assets/img_VillagePlayer.png",i=e.p+"assets/village.png",r=e.p+"assets/1.png",n=e.p+"assets/2.png",o=e.p+"assets/3.png",a=e.p+"assets/paper.png",h=e.p+"assets/chalk.jpg",w=e.p+"assets/MajavaVillage.png",l=e.p+"assets/f.png";(new Image).src=t;const d=new Image;d.src=s;const p=new Image;p.src=i;const c=new Image;c.src=r;const y=new Image;y.src=n;const m=new Image;m.src=o;const g=new Image;g.src=a;const u=new Image;u.src=h;const x=new Image;x.src=w;const f=new Image;f.src=l;const S=document.querySelector("canvas"),v=S.getContext("2d"),C={x:.2,y:.08},M={x:-window.innerWidth/2,y:-window.innerHeight/2},b=new class{constructor(e=!1){this.mouseCoord={x:0,y:0},this.mouseDown={},this.mouseQuery={},this.key={},this.query={},window.addEventListener("keydown",(e=>{this.key[e.code]=!0})),window.addEventListener("keyup",(e=>{this.key[e.code]=!1,this.query[e.code]=!1})),S.addEventListener("mousemove",(e=>{this.mouseCoord={x:e.offsetX,y:e.offsetY}})),S.addEventListener("mousedown",(e=>{this.mouseDown[e.button]=!0})),S.addEventListener("mouseup",(e=>{this.mouseDown[e.button]=!1,this.mouseQuery[e.button]=!1})),e&&S.addEventListener("contextmenu",(e=>{e.preventDefault()}))}isKeyDown(e){return!0===this.key[e]}keyPressed(e){return!0!==this.query[e]&&!0===this.key[e]&&(this.query[e]=!0,!0)}getMousePosition(){return this.mouseCoord}isMouseDown(e=0){return this.mouseDown[e]}mousePressed(e=0){return!0!==this.mouseQuery[e]&&!0===this.mouseDown[e]&&(this.mouseQuery[e]=!0,!0)}resetCanvas(){v.clearRect(0,0,S.width,S.height),S.width=window.innerWidth,S.height=window.innerHeight}fillCanvas(e="#FF10F0"){v.beginPath(),v.rect(0,0,S.width,S.height),v.fillStyle=e,v.fill()}drawPicCam(e,t,s,i,r){v.drawImage(e,t-i/2-M.x,s-r/2-M.y,i,r)}drawPic(e,t,s,i,r){v.drawImage(e,t,s,i,r)}writeText(e,t,s,i="center",r="sans-serif",n=20,o="red"){v.font=`${n}px ${r}`,v.fillStyle=o,v.textAlign=i,v.fillText(e,t,s)}resetCam(){C.x=.2,C.y=.08,M.x=-window.innerWidth/2,M.y=-window.innerHeight/2}}(!1);class k{constructor(){this.col=0,this.tick=0}animate(e,t,s,i,r,n,o,a,h,w){const l=Math.floor(this.tick/w)%h;this.col=t*l,v.drawImage(e,this.col,a*s,t,s,i,r,n,o),this.tick%w==0&&(this.col<h?this.col++:this.col=0),this.tick++}animateCam(e,t,s,i,r,n,o,a,h,w){const l=Math.floor(this.tick/w)%h;this.col=t*l,v.drawImage(e,this.col,a*s,t,s,i-n/2-M.x,r-o/2-M.y,n,o),this.tick%w==0&&(this.col<h?this.col++:this.col=0),this.tick++}}const D=[];class P{update(){this.render()}render(){b.drawPicCam(x,0,0,3*window.innerWidth,3*window.innerHeight)}}class T{constructor(){this.playerSpr={img:d,crop:{x:30,y:47.83},pos:{x:-880,y:-400},size:{x:80,y:100},row:0,maxCol:0,frame:4},this.playerAnim=new k,this.speed=7,this.active=!0}update(){this.render(this.playerSpr),this.move(this.playerSpr),this.cameraFollow(this.playerSpr),this.collision(this.playerSpr)}render(e){this.playerAnim.animateCam(d,e.crop.x,e.crop.y,e.pos.x,e.pos.y,e.size.x,e.size.y,e.row,e.maxCol,e.frame)}collision(e){const t=e.pos.x-e.size.x/6,s=e.pos.x+e.size.x/6,i=e.pos.y-e.size.y/16,r=e.pos.y+e.size.y/2;D.forEach((n=>{t<n.right&&s>n.left&&i<n.bottom&&r>n.top?(this.speed=0,b.isKeyDown("KeyD")?e.pos.x-=7:b.isKeyDown("KeyA")?e.pos.x+=7:b.isKeyDown("KeyS")?e.pos.y-=7:b.isKeyDown("KeyW")&&(e.pos.y+=7)):this.speed=7})),t<-355&&s>-655&&i<-410&&r>-630&&(b.isKeyDown("KeyF")&&(this.active=!1,console.log("F")),b.drawPicCam(f,-400,-500,50,50)),e.pos.x<-900&&(e.pos.x=-900),e.pos.y>-300&&(e.pos.y=-300),e.pos.x>-300&&(e.pos.x=-300),e.pos.y<-660&&(e.pos.y=-660)}cameraFollow(e){M.x=Math.round(M.x-(M.x+S.width/2-e.pos.x)*C.x),M.y=Math.round(M.y-(M.y+S.height/2-e.pos.y)*C.y)}move(e){b.isKeyDown("KeyD")?(e.maxCol=8,e.row=0,e.pos.x+=this.speed):b.isKeyDown("KeyA")?(e.maxCol=8,e.row=1,e.pos.x-=this.speed):b.isKeyDown("KeyS")?(e.maxCol=8,e.row=2,e.pos.y+=this.speed):b.isKeyDown("KeyW")?(e.maxCol=8,e.row=3,e.pos.y-=this.speed):3==e.row?(e.maxCol=4,e.row=7):2==e.row?(e.maxCol=4,e.row=4):1==e.row?(e.maxCol=4,e.row=5):0==e.row&&(e.maxCol=4,e.row=6)}}class W{constructor(){this.active=!0,this.player=new T,this.map=new P}update(){this.player.active?(this.map.update(),this.player.update()):this.active=!1}render(){}}class K{constructor(){this.active=!1,this.paperAnim=new k,this.paperSprite={img:g,crop:{x:48,y:32},pos:{x:200,y:-100},size:{x:120,y:80},row:2,maxCol:8,frame:30},this.prlxM0=0,this.prlxM1=0,this.prlxM2=0,this.distance=0,this.speed=30,this.fall=1,this.boost=0,this.startTimer=1,this.terms={x:22,y:5},this.answer="",this.lost=!1}update(){this.lost||(this.equation(),this.vFX(this.paperSprite),this.cameraFollow(this.paperSprite)),this.render(this.paperSprite)}render(e){this.prlxM0+=this.speed,this.prlxM0>window.outerWidth/2&&(this.prlxM0=0),this.prlxM1+=this.speed,this.prlxM1>4*window.outerWidth&&(this.prlxM1=0),this.prlxM2+=this.speed,this.prlxM2>6*window.outerHeight&&(this.prlxM2=0),b.drawPicCam(c,-this.prlxM0,50,window.innerWidth,2*window.innerHeight),b.drawPicCam(c,-this.prlxM0+window.innerWidth,50,window.innerWidth,2*window.innerHeight),b.drawPicCam(y,-this.prlxM1+2*window.outerWidth,50,2*window.innerWidth,2*window.innerHeight),b.drawPicCam(m,-this.prlxM2+2*window.outerWidth,50,2*window.innerWidth,2*window.innerHeight),this.paperAnim.animateCam(e.img,e.crop.x,e.crop.y,e.pos.x,e.pos.y,e.size.x,e.size.y,e.row,e.maxCol,e.frame),b.writeText(`${Math.round(this.distance/40)} m`,180,50,"center","Papyrus",50,"black"),b.drawPic(u,110,70,120,100),b.writeText(`${this.terms.x} * ${this.terms.y}`,170,110,"center","Comic Sans MS",30,"beige"),b.writeText(`= ${this.answer}`,130,150,"left","Comic Sans MS",30,"azure"),this.startTimer>0&&(b.fillCanvas(`rgb(0, 0, 0, ${this.startTimer})`),this.startTimer-=.1),this.lost&&(b.fillCanvas("rgb(0, 0, 0)"),b.writeText('Druk op "R" om te resetten.',window.innerWidth/2,150,"center","Navigator",20,"wheat"),b.writeText('druk op "V" om terug te gaan naar het dorp.',window.innerWidth/2,100,"center","Navigator",20,"wheat"),b.writeText(`Afstand: ${Math.round(this.distance/40)}m`,window.innerWidth/2,200,"center","Navigator",20,"wheat"))}cameraFollow(e){M.x=Math.round(M.x-(M.x+S.width/2-e.pos.x)*C.x),e.pos.y<window.innerHeight/2&&(M.y=Math.round(M.y-(M.y+S.height/2-e.pos.y)*C.y))}equation(){this.terms.x*this.terms.y==parseFloat(this.answer)&&(this.terms.x=Math.floor(10*Math.random())+1,this.terms.y=Math.floor(10*Math.random())+1,this.answer="",this.boost=30),b.keyPressed("Digit0")&&this.answer.length<4?this.answer+="0":b.keyPressed("Digit1")&&this.answer.length<4?this.answer+="1":b.keyPressed("Digit2")&&this.answer.length<4?this.answer+="2":b.keyPressed("Digit3")&&this.answer.length<4?this.answer+="3":b.keyPressed("Digit4")&&this.answer.length<4?this.answer+="4":b.keyPressed("Digit5")&&this.answer.length<4?this.answer+="5":b.keyPressed("Digit6")&&this.answer.length<4?this.answer+="6":b.keyPressed("Digit7")&&this.answer.length<4?this.answer+="7":b.keyPressed("Digit8")&&this.answer.length<4?this.answer+="8":b.keyPressed("Digit9")&&this.answer.length<4?this.answer+="9":b.keyPressed("Backspace")&&(this.answer=this.answer.slice(0,-1))}vFX(e){this.boost>0&&(e.pos.y-=4,e.pos.x+=6,this.speed+=1,this.boost-=1),this.distance+=Math.floor(this.speed/5),this.speed-=.05,this.speed<1&&(this.speed=1),this.speed>60&&(this.speed=60),e.pos.y+=this.fall,e.pos.y>window.innerHeight&&(this.lost=!0),e.pos.y<-window.innerHeight/2.5&&(e.pos.y=-window.innerHeight/2.5),e.pos.x>window.innerWidth/2.5&&(e.pos.x=window.innerWidth/2.5),this.speed<=5?(e.frame=10,this.fall=3.5,e.row=1,e.maxCol=2):this.speed>10&&this.speed<=20?(e.frame=15,this.fall=.5):this.speed>20&&this.speed<=30?(e.frame=11,this.fall=.4):this.speed>30&&this.speed<=40?(e.frame=7,this.fall=.3,e.row=3,e.maxCol=15):this.speed>40&&this.speed<=50?(e.frame=3,this.fall=.2):this.speed>50&&(e.frame=2,e.pos.y+=.1)}}class F{constructor(){this.image=p,this.button={x:window.innerWidth/2-100,y:window.innerHeight/2,width:200,height:50,text:"Spel Starten"},this.gameStarted=!1}processInput(){const e=b.getMousePosition(),t=this.button;b.mousePressed(0)&&e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height&&(this.gameStarted=!0)}update(){this.processInput(),this.render()}render(){b.drawPic(this.image,0,0,window.innerWidth,window.innerHeight),v.fillStyle="rgba(222, 222, 222, 0.64)",v.fillRect(480,135,400,50),v.fillStyle="black",v.font="40px Sans",v.textAlign="center",v.textBaseline="middle",v.fillText("Welkom bij majava",window.innerWidth/2,window.innerHeight/4),v.fillStyle="#FF5722",v.fillRect(this.button.x,this.button.y,this.button.width,this.button.height),v.fillStyle="#FFFFFF",v.font="20px Arial",v.textAlign="center",v.textBaseline="middle",v.fillText(this.button.text,this.button.x+this.button.width/2,this.button.y+this.button.height/2)}}const I=new class{constructor(){this.frameT=1e3/60,this.deltaT=0,this.lastT=0,this.villageScene=new W,this.planeScene=new K,this.startScene=new F}start(){this.update(0)}update(e){requestAnimationFrame(this.update.bind(this)),this.deltaT=(e-this.lastT)/this.frameT,this.lastT=e,this.deltaT>.01&&(this.render(),this.startScene.gameStarted&&this.villageScene.active?(this.villageScene.update(),this.planeScene.active=!1):this.startScene.gameStarted&&!this.villageScene.active&&(this.planeScene.update(),this.planeScene.active=!0),0==this.startScene.gameStarted&&this.startScene.update(),b.isKeyDown("KeyV")&&(this.villageScene=new W,this.villageScene.active=!0,this.reset()),b.isKeyDown("KeyR")&&this.planeScene.active&&(this.planeScene=new K,this.planeScene.active=!0,this.villageScene.active=!1,this.reset()))}render(){b.resetCanvas()}reset(){b.resetCam()}};window.addEventListener("load",(()=>I.start()))})();